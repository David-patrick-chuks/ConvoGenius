Refactor trainingWorker.ts for better concurrency
